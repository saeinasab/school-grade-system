' ðŸ« Ù†Ù…ÙˆÙ†Ù‡ Ø¹Ù…Ù„ÛŒ: Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ù„Ø§Ø³ Ø¯Ù‡Ù… Ø±ÛŒØ§Ø¶ÛŒ
' Ù…Ø¯Ø±Ø³Ù‡: Ù†Ù…ÙˆÙ†Ù‡ Ø¯ÙˆÙ„ØªÛŒ Ø§Ù…ÛŒØ±Ú©Ø¨ÛŒØ±
' Ù…Ø¹Ù„Ù…: Ø³Ø¹ÛŒØ¯ Ø³Ø§Ø¹ÛŒ Ù†Ø³Ø¨
' Ø³Ø§Ù„ ØªØ­ØµÛŒÙ„ÛŒ: Û±Û´Û°Û³-Û±Û´Û°Û´

Public Sub CreateSampleClass()
    Call InitializeSystem
    Call AddTenthGradeMathClass
    Call AddSampleScores
    Call GenerateClassReport
    MsgBox "Ù†Ù…ÙˆÙ†Ù‡ Ú©Ù„Ø§Ø³ Ø¯Ù‡Ù… Ø±ÛŒØ§Ø¶ÛŒ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯!", vbInformation
End Sub

Public Sub AddTenthGradeMathClass()
    ' Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¯Ø±ÙˆØ³ ØªØ®ØµØµÛŒ Ø¯Ù‡Ù… Ø±ÛŒØ§Ø¶ÛŒ
    AddSubject "Ø±ÛŒØ§Ø¶ÛŒâ€ŒØ§Øª", "Ø¢Ù‚Ø§ÛŒ Ù…Ø­Ù…Ø¯ÛŒ", 4
    AddSubject "ÙÛŒØ²ÛŒÚ©", "Ø®Ø§Ù†Ù… Ø§Ø­Ù…Ø¯ÛŒ", 3
    AddSubject "Ø´ÛŒÙ…ÛŒ", "Ø¢Ù‚Ø§ÛŒ Ø±Ø¶Ø§ÛŒÛŒ", 3
    AddSubject "Ø²ÛŒØ³Øªâ€ŒØ´Ù†Ø§Ø³ÛŒ", "Ø®Ø§Ù†Ù… Ú©Ø±ÛŒÙ…ÛŒ", 3
    AddSubject "Ø§Ø¯Ø¨ÛŒØ§Øª", "Ø¢Ù‚Ø§ÛŒ Ø­Ø³ÛŒÙ†ÛŒ", 2
    AddSubject "Ø¯ÛŒÙ†ÛŒ", "Ø®Ø§Ù†Ù… Ù…ÙˆØ³ÙˆÛŒ", 2
    AddSubject "Ø²Ø¨Ø§Ù† Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ", "Ø¢Ù‚Ø§ÛŒ ÙÙ„Ø§Ø­ÛŒ", 2
    AddSubject "ÙˆØ±Ø²Ø´", "Ø¢Ù‚Ø§ÛŒ Ù‚Ø±Ø¨Ø§Ù†ÛŒ", 1
End Sub

Public Sub AddSampleStudents()
    ' Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù† Ú©Ù„Ø§Ø³ Ø¯Ù‡Ù… Ø±ÛŒØ§Ø¶ÛŒ
    AddStudent "Ù…Ø­Ù…Ø¯", "Ø±Ø¶Ø§ÛŒÛŒ", 10, "Ø¯Ù‡Ù… Ø±ÛŒØ§Ø¶ÛŒ", "09123456789"
    AddStudent "ÙØ§Ø·Ù…Ù‡", "Ù…Ø­Ù…Ø¯ÛŒ", 10, "Ø¯Ù‡Ù… Ø±ÛŒØ§Ø¶ÛŒ", "09123456790"
    AddStudent "Ø¹Ù„ÛŒ", "Ú©Ø±ÛŒÙ…ÛŒ", 10, "Ø¯Ù‡Ù… Ø±ÛŒØ§Ø¶ÛŒ", "09123456791"
    AddStudent "Ø²Ù‡Ø±Ø§", "Ø§Ø­Ù…Ø¯ÛŒ", 10, "Ø¯Ù‡Ù… Ø±ÛŒØ§Ø¶ÛŒ", "09123456792"
    AddStudent "Ø­Ø³ÛŒÙ†", "Ø¬Ø¹ÙØ±ÛŒ", 10, "Ø¯Ù‡Ù… Ø±ÛŒØ§Ø¶ÛŒ", "09123456793"
    AddStudent "Ù†Ø±Ú¯Ø³", "Ù‚Ø§Ø³Ù…ÛŒ", 10, "Ø¯Ù‡Ù… Ø±ÛŒØ§Ø¶ÛŒ", "09123456794"
End Sub

Public Sub AddSampleScores()
    ' Ù†Ù…Ø±Ø§Øª Ù…Ø§Ù‡ Ù…Ù‡Ø± Ø¨Ø±Ø§ÛŒ ØªÙ…Ø§Ù… Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù†
    AddMonthlyScores 7, 1403  ' Ù…Ø§Ù‡ Ù…Ù‡Ø±
End Sub

' ðŸ“Š Ø§ÛŒØ¬Ø§Ø¯ Ú¯Ø²Ø§Ø±Ø´ Ú©Ù„Ø§Ø³ÛŒ
Public Sub GenerateClassReport()
    Dim Report As String
    Report = "Ú¯Ø²Ø§Ø±Ø´ Ú©Ù„Ø§Ø³ Ø¯Ù‡Ù… Ø±ÛŒØ§Ø¶ÛŒ - Ù…Ø§Ù‡ Ù…Ù‡Ø± Û±Û´Û°Û³" & vbCrLf & vbCrLf
    
    Report = Report & "ðŸ“Š Ø¢Ù…Ø§Ø± Ú©Ù„Ø§Ø³ÛŒ:" & vbCrLf
    Report = Report & "ØªØ¹Ø¯Ø§Ø¯ Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù†: " & GetStudentCount(10, "Ø¯Ù‡Ù… Ø±ÛŒØ§Ø¶ÛŒ") & vbCrLf
    Report = Report & "ØªØ¹Ø¯Ø§Ø¯ Ø¯Ø±ÙˆØ³: " & GetSubjectCount() & vbCrLf
    Report = Report & "Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ú©Ù„ Ú©Ù„Ø§Ø³: " & GetClassAverage(10, "Ø¯Ù‡Ù… Ø±ÛŒØ§Ø¶ÛŒ", 7, 1403) & vbCrLf & vbCrLf
    
    Report = Report & "ðŸ† Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù† Ø¨Ø±ØªØ±:" & vbCrLf
    Report = Report & GetTopStudents(10, "Ø¯Ù‡Ù… Ø±ÛŒØ§Ø¶ÛŒ", 7, 1403, 3) & vbCrLf
    
    Report = Report & "ðŸ“ˆ Ù†Ù…ÙˆØ¯Ø§Ø± Ù†Ù…Ø±Ø§Øª:" & vbCrLf
    Report = Report & GetScoreDistribution(10, "Ø¯Ù‡Ù… Ø±ÛŒØ§Ø¶ÛŒ", 7, 1403)
    
    ' Ù†Ù…Ø§ÛŒØ´ Ú¯Ø²Ø§Ø±Ø´
    MsgBox Report, vbInformation, "Ú¯Ø²Ø§Ø±Ø´ Ú©Ù„Ø§Ø³ÛŒ"
End Sub

' ðŸŽ¯ ØªÙˆØ§Ø¨Ø¹ Ú©Ù…Ú©ÛŒ
Public Function GetStudentCount(Grade As Integer, ClassName As String) As Integer
    Dim rs As Recordset
    Set rs = CurrentDb.OpenRecordset( _
        "SELECT COUNT(*) FROM Students WHERE Grade=" & Grade & " AND Class='" & ClassName & "'")
    GetStudentCount = rs.Fields(0).Value
    rs.Close
End Function

Public Function GetClassAverage(Grade As Integer, ClassName As String, Month As Integer, Year As Integer) As String
    ' Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ú©Ù„Ø§Ø³
    Dim Total As Double, Count As Integer
    Dim rs As Recordset
    Set rs = CurrentDb.OpenRecordset( _
        "SELECT StudentID FROM Students WHERE Grade=" & Grade & " AND Class='" & ClassName & "'")
    
    Do While Not rs.EOF
        Total = Total + CalculateStudentAverage(rs!StudentID, Month, Year)
        Count = Count + 1
        rs.MoveNext
    Loop
    
    If Count > 0 Then
        GetClassAverage = Format(Total / Count, "0.00")
    Else
        GetClassAverage = "0.00"
    End If
    rs.Close
End Function
