' ========================
' Ø³ÛŒØ³ØªÙ… Ù…Ø¯ÛŒØ±ÛŒØª Ù†Ù…Ø±Ø§Øª Ø¯Ø¨ÛŒØ±Ø³ØªØ§Ù†
' ØªÙˆØ³Ø¹Ù‡â€ŒØ¯Ù‡Ù†Ø¯Ù‡: Ø³Ø¹ÛŒÙ†Ø³Ø¨
' ========================

Option Compare Database
Option Explicit

Public Const PERSIAN_FONT As String = "Vazir FD"

Public Sub InitializeSystem()
    Call CreateMainTables
    Call CreateMainForm
    Call AddSampleData
    MsgBox "Ø³ÛŒØ³ØªÙ… Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³Øª! Ù„Ø·ÙØ§ ÙØ±Ù… Ø§ØµÙ„ÛŒ Ø±Ø§ Ø¨Ø§Ø² Ú©Ù†ÛŒØ¯.", vbInformation
End Sub

Public Sub CreateMainTables()
    On Error Resume Next
    CurrentDb.Execute "DROP TABLE Students"
    CurrentDb.Execute "DROP TABLE Subjects"
    On Error GoTo 0
    
    ' Ø§ÛŒØ¬Ø§Ø¯ Ø¬Ø¯ÙˆÙ„ Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù†
    Dim sql As String
    sql = "CREATE TABLE Students (" & _
          "StudentID AUTOINCREMENT PRIMARY KEY, " & _
          "FirstName TEXT(50), " & _
          "LastName TEXT(50), " & _
          "Grade INTEGER, " & _
          "Class TEXT(10), " & _
          "EnrollmentDate DATE, " & _
          "IsActive YESNO)"
    CurrentDb.Execute sql
    
    ' Ø§ÛŒØ¬Ø§Ø¯ Ø¬Ø¯ÙˆÙ„ Ø¯Ø±ÙˆØ³
    sql = "CREATE TABLE Subjects (" & _
          "SubjectID AUTOINCREMENT PRIMARY KEY, " & _
          "SubjectName TEXT(100), " & _
          "TeacherName TEXT(100), " & _
          "UnitCount INTEGER, " & _
          "IsActive YESNO)"
    CurrentDb.Execute sql
    
    MsgBox "Ø¬Ø¯Ø§ÙˆÙ„ Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯Ù†Ø¯", vbInformation
End Sub

Public Sub CreateMainForm()
    Dim frm As Form
    Set frm = CreateForm()
    
    With frm
        .Caption = "Ø³ÛŒØ³ØªÙ… Ù…Ø¯ÛŒØ±ÛŒØª Ù†Ù…Ø±Ø§Øª - Ù†Ø³Ø®Ù‡ 1.0"
        .Width = 900
        .Height = 600
        .AutoCenter = True
    End With
    
    ' Ø¹Ù†ÙˆØ§Ù† Ø§ØµÙ„ÛŒ
    Dim lbl As Label
    Set lbl = frm.CreateControl("Label", acLabel, , , , 100, 50, 700, 60)
    With lbl
        .Caption = "Ø³ÛŒØ³ØªÙ… Ù…Ø¯ÛŒØ±ÛŒØª Ù†Ù…Ø±Ø§Øª Ø¯Ø¨ÛŒØ±Ø³ØªØ§Ù†"
        .FontSize = 16
        .FontBold = True
        .TextAlign = 2
    End With
    
    ' Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ù†Ùˆ
    CreateMenuButton frm, "ğŸ‘¥ Ù…Ø¯ÛŒØ±ÛŒØª Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù†", 300, 150
    CreateMenuButton frm, "ğŸ“ ÙˆØ±ÙˆØ¯ Ù†Ù…Ø±Ø§Øª", 300, 220
    CreateMenuButton frm, "ğŸ“š Ù…Ø¯ÛŒØ±ÛŒØª Ø¯Ø±ÙˆØ³", 300, 290
    CreateMenuButton frm, "ğŸ“Š Ú¯Ø²Ø§Ø±Ø´Ø§Øª", 300, 360
    CreateMenuButton frm, "ğŸšª Ø®Ø±ÙˆØ¬", 300, 430
    
    DoCmd.Save "frmMainMenu"
    DoCmd.Close acForm, "frmMainMenu", acSaveYes
    MsgBox "ÙØ±Ù… Ø§ØµÙ„ÛŒ Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯", vbInformation
End Sub

Private Sub CreateMenuButton(frm As Form, Caption As String, Left As Integer, Top As Integer)
    Dim btn As CommandButton
    Set btn = frm.CreateControl("CommandButton", acCommandButton, , , , Left, Top, 300, 45)
    With btn
        .Caption = Caption
        .FontSize = 11
        .FontBold = True
    End With
End Sub

Public Sub AddSampleData()
    ' Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¯Ø±ÙˆØ³ Ù†Ù…ÙˆÙ†Ù‡
    CurrentDb.Execute "INSERT INTO Subjects (SubjectName, TeacherName, UnitCount, IsActive) " & _
                     "VALUES ('Ø±ÛŒØ§Ø¶ÛŒ', 'Ø¢Ù‚Ø§ÛŒ Ù…Ø­Ù…Ø¯ÛŒ', 3, True)"
    
    CurrentDb.Execute "INSERT INTO Subjects (SubjectName, TeacherName, UnitCount, IsActive) " & _
                     "VALUES ('ÙÛŒØ²ÛŒÚ©', 'Ø®Ø§Ù†Ù… Ø§Ø­Ù…Ø¯ÛŒ', 2, True)"
    
    ' Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù† Ù†Ù…ÙˆÙ†Ù‡
    CurrentDb.Execute "INSERT INTO Students (FirstName, LastName, Grade, Class, EnrollmentDate, IsActive) " & _
                     "VALUES ('Ø¹Ù„ÛŒ', 'Ù…Ø­Ù…Ø¯ÛŒ', 10, '10A', Date(), True)"
    
    CurrentDb.Execute "INSERT INTO Students (FirstName, LastName, Grade, Class, EnrollmentDate, IsActive) " & _
                     "VALUES ('ÙØ§Ø·Ù…Ù‡', 'Ø±Ø¶Ø§ÛŒÛŒ', 10, '10A', Date(), True)"
    
    MsgBox "Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù†Ø¯", vbInformation
End Sub

' ØªØ§Ø¨Ø¹ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…ÛŒØ§Ù†Ú¯ÛŒÙ†
Public Function CalculateAverage(StudentID As Long) As Double
    Dim rs As Recordset
    Set rs = CurrentDb.OpenRecordset("SELECT AVG(Score) FROM MonthlyScores WHERE StudentID=" & StudentID)
    CalculateAverage = Nz(rs.Fields(0).Value, 0)
    rs.Close
End Function
