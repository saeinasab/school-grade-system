Option Compare Database
Option Explicit

' ğŸ¯ Ø³ÛŒØ³ØªÙ… Ù…Ø¯ÛŒØ±ÛŒØª Ù†Ù…Ø±Ø§Øª Ø¯Ø¨ÛŒØ±Ø³ØªØ§Ù†
' ØªÙˆØ³Ø¹Ù‡â€ŒØ¯Ù‡Ù†Ø¯Ù‡: Ø³Ø¹ÛŒØ¯ Ø³Ø§Ø¹ÛŒ Ù†Ø³Ø¨
' ØªØ§Ø±ÛŒØ®: Û±Û´Û°Û³

Public Sub CreateCompleteDatabase()
    On Error GoTo ErrorHandler
    
    Call CreateAllTables
    Call CreateMainForms
    Call AddSampleData
    Call ApplyPersianSettings
    
    MsgBox "âœ… Ù¾Ø§ÛŒÚ¯Ø§Ù‡ Ø¯Ø§Ø¯Ù‡ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯!" & vbCrLf & _
           "Ø³ÛŒØ³ØªÙ… Ù…Ø¯ÛŒØ±ÛŒØª Ù†Ù…Ø±Ø§Øª Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø³Øª.", vbInformation
    
    Exit Sub

ErrorHandler:
    MsgBox "âŒ Ø®Ø·Ø§ Ø¯Ø± Ø§ÛŒØ¬Ø§Ø¯ Ù¾Ø§ÛŒÚ¯Ø§Ù‡ Ø¯Ø§Ø¯Ù‡: " & Err.Description, vbCritical
End Sub

' ğŸ“Š Ø§ÛŒØ¬Ø§Ø¯ ØªÙ…Ø§Ù… Ø¬Ø¯Ø§ÙˆÙ„
Public Sub CreateAllTables()
    ' Ø¬Ø¯ÙˆÙ„ Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù†
    If Not TableExists("Students") Then
        CurrentDb.Execute "CREATE TABLE Students (" & _
            "StudentID AUTOINCREMENT PRIMARY KEY, " & _
            "FirstName TEXT(50) NOT NULL, " & _
            "LastName TEXT(50) NOT NULL, " & _
            "Grade INTEGER NOT NULL, " & _
            "Class TEXT(10) NOT NULL, " & _
            "EnrollmentDate DATE DEFAULT DATE(), " & _
            "Phone TEXT(15), " & _
            "Address TEXT(255), " & _
            "IsActive YESNO DEFAULT TRUE)"
    End If
    
    ' Ø¬Ø¯ÙˆÙ„ Ø¯Ø±ÙˆØ³
    If Not TableExists("Subjects") Then
        CurrentDb.Execute "CREATE TABLE Subjects (" & _
            "SubjectID AUTOINCREMENT PRIMARY KEY, " & _
            "SubjectName TEXT(100) NOT NULL, " & _
            "TeacherName TEXT(100) NOT NULL, " & _
            "UnitCount INTEGER DEFAULT 1, " & _
            "MinScore INTEGER DEFAULT 10, " & _
            "Description TEXT(255), " & _
            "IsActive YESNO DEFAULT TRUE)"
    End If
    
    ' Ø¬Ø¯ÙˆÙ„ Ù†Ù…Ø±Ø§Øª Ù…Ø§Ù‡Ø§Ù†Ù‡
    If Not TableExists("MonthlyScores") Then
        CurrentDb.Execute "CREATE TABLE MonthlyScores (" & _
            "ScoreID AUTOINCREMENT PRIMARY KEY, " & _
            "StudentID LONG NOT NULL, " & _
            "SubjectID LONG NOT NULL, " & _
            "Month INTEGER NOT NULL, " & _
            "Year INTEGER NOT NULL, " & _
            "Score DOUBLE NOT NULL, " & _
            "ExamType TEXT(50) DEFAULT 'Ø¹Ø§Ø¯ÛŒ', " & _
            "RecordDate DATE DEFAULT DATE(), " & _
            "RecordedBy TEXT(100), " & _
            "Description TEXT(255))"
    End If
    
    ' Ø¬Ø¯ÙˆÙ„ Ú©Ù„Ø§Ø³â€ŒÙ‡Ø§
    If Not TableExists("Classes") Then
        CurrentDb.Execute "CREATE TABLE Classes (" & _
            "ClassID AUTOINCREMENT PRIMARY KEY, " & _
            "ClassName TEXT(20) NOT NULL, " & _
            "GradeLevel INTEGER NOT NULL, " & _
            "HomeroomTeacher TEXT(100), " & _
            "StudentCount INTEGER DEFAULT 0, " & _
            "IsActive YESNO DEFAULT TRUE)"
    End If
End Sub

' ğŸ¨ Ø§ÛŒØ¬Ø§Ø¯ ÙØ±Ù…â€ŒÙ‡Ø§ÛŒ Ø§ØµÙ„ÛŒ
Public Sub CreateMainForms()
    CreateMainMenuForm
    CreateStudentManagementForm
    CreateScoreEntryForm
    CreateSubjectManagementForm
End Sub

' ğŸ“ Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡
Public Sub AddSampleData()
    ' Ø¯Ø±ÙˆØ³ Ù†Ù…ÙˆÙ†Ù‡
    AddSampleSubjects
    ' Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù† Ù†Ù…ÙˆÙ†Ù‡
    AddSampleStudents
    ' Ú©Ù„Ø§Ø³â€ŒÙ‡Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡
    AddSampleClasses
End Sub

' ğŸ”§ ØªÙ†Ø¸ÛŒÙ…Ø§Øª ÙØ§Ø±Ø³ÛŒ
Public Sub ApplyPersianSettings()
    ' Ø§ÛŒÙ†Ø¬Ø§ ØªÙ†Ø¸ÛŒÙ…Ø§Øª ÙÙˆÙ†Øª Ùˆ Ø±Ø§Ø³Øªâ€ŒÚ†ÛŒÙ† Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
    MsgBox "ØªÙ†Ø¸ÛŒÙ…Ø§Øª ÙØ§Ø±Ø³ÛŒ Ø§Ø¹Ù…Ø§Ù„ Ø´Ø¯", vbInformation
End Sub

' ğŸ” Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¬ÙˆØ¯ Ø¬Ø¯ÙˆÙ„
Public Function TableExists(TableName As String) As Boolean
    On Error Resume Next
    TableExists = (CurrentDb.TableDefs(TableName).Name = TableName)
    On Error GoTo 0
End Function
